# F1 Motion Simulator Configuration
# ==================================
#
# This file contains all tunable parameters for the motion simulator.
# Adjust these values based on hardware testing and user preference.
#
# IMPORTANT: Start with conservative values and increase gradually!

# =============================================================================
# TELEMETRY SETTINGS
# =============================================================================
telemetry:
  port: 20777           # F1 game UDP port (don't change unless game is different)
  buffer_size: 2048     # UDP receive buffer size

# =============================================================================
# MOTION ALGORITHM SETTINGS
# =============================================================================
# These settings control how G-forces are translated to actuator movement.
# The washout filter provides onset cue while returning to center.
#
motion:
  # -------------------------------------------------------------------------
  # Dimension Selection
  # -------------------------------------------------------------------------
  # Which telemetry input drives the actuator:
  #   surge  - Longitudinal G-force (braking/acceleration) [RECOMMENDED]
  #   sway   - Lateral G-force (cornering)
  #   heave  - Vertical G-force (bumps/kerbs)
  #   pitch  - Pitch angle from game
  #   roll   - Roll angle from game
  dimension: surge

  # -------------------------------------------------------------------------
  # Washout Filter Settings
  # -------------------------------------------------------------------------
  # High-pass filter cutoff frequency (Hz)
  # Lower = more sustained feel but risk hitting limits
  # Higher = quicker return to center, more responsive
  # Recommended range: 0.5 - 2.0 Hz
  highpass_cutoff_hz: 1.0

  # -------------------------------------------------------------------------
  # Gain Settings
  # -------------------------------------------------------------------------
  # How much the actuator moves per unit of input
  # For G-forces: mm per G (e.g., 100 = 1G causes 100mm movement)
  # For angles: mm per radian
  # START LOW and increase gradually!
  gain: 100.0

  # -------------------------------------------------------------------------
  # Anti-Oscillation Settings
  # -------------------------------------------------------------------------
  # Deadband: Ignore input changes smaller than this value
  # Units: G (for G-forces) or radians (for angles)
  # Higher = less responsive but more stable
  deadband: 0.05

  # Slew rate limit: Maximum position change per second (mm/s)
  # Prevents jerky motion and reduces oscillation
  # Lower = smoother but slower response
  slew_rate_limit: 500.0

  # -------------------------------------------------------------------------
  # Actuator Limits
  # -------------------------------------------------------------------------
  stroke_mm: 900.0      # Total actuator stroke (LEL25LT-900)
  center_mm: 450.0      # Center/home position
  soft_limit_mm: 50.0   # Safety margin from each end

  # -------------------------------------------------------------------------
  # Processing Rate
  # -------------------------------------------------------------------------
  # Motion algorithm update rate (Hz)
  # Should match command_rate_hz in hardware settings
  update_rate_hz: 30.0

# =============================================================================
# HARDWARE SETTINGS
# =============================================================================
hardware:
  # ---------------------------------------------------------------------------
  # SMC LECP6P Controller Settings
  # ---------------------------------------------------------------------------
  smc:
    # Serial connection
    port: "/dev/ttyUSB0"    # Linux: /dev/ttyUSB0, Windows: COM3
    baudrate: 38400         # Fixed by SMC protocol
    parity: "N"             # No parity (some controllers use "E")
    controller_id: 1        # Modbus slave ID

    # Actuator specifications (LEL25LT-900)
    stroke_mm: 900.0        # Total stroke length
    center_mm: 450.0        # Center position for operation
    soft_limit_mm: 5.0      # Hardware safety margin from ends

    # Motion profile settings
    default_speed: 500      # Movement speed (mm/s)
    default_accel: 3000     # Acceleration (mm/s²)
    default_decel: 3000     # Deceleration (mm/s²)

    # Command rate (CRITICAL for anti-oscillation)
    # Do NOT exceed 30Hz - higher rates cause oscillation!
    command_rate_hz: 30.0

  # ---------------------------------------------------------------------------
  # MOOG 6-DOF Platform Settings (Future Sprint)
  # ---------------------------------------------------------------------------
  moog:
    ip: "192.168.1.100"     # Platform IP address
    port: 6000              # UDP port
    send_rate_hz: 60.0      # Command rate

# =============================================================================
# TUNING GUIDE
# =============================================================================
# 1. Start with gain = 50.0 (very conservative)
# 2. Test with gentle braking in game
# 3. Gradually increase gain until motion feels responsive
# 4. If oscillation occurs:
#    - Decrease command_rate_hz (try 20Hz)
#    - Increase deadband (try 0.1)
#    - Decrease slew_rate_limit (try 300)
# 5. Adjust highpass_cutoff_hz for washout feel:
#    - Lower (0.5Hz) = more sustained motion
#    - Higher (2.0Hz) = quicker return to center
# 6. Save your final tuned values!
#
# Known Issues and Solutions:
# - Oscillation: Reduce command_rate_hz and/or increase deadband
# - Random movement: Check telemetry connection, increase deadband
# - Motion doesn't match game: Adjust gain and highpass_cutoff_hz
# - Hits end stops: Reduce gain or increase soft_limit_mm
